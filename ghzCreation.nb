(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     95218,       2274]
NotebookOptionsPosition[     93540,       2217]
NotebookOutlinePosition[     93883,       2232]
CellTagsIndexPosition[     93840,       2229]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["BASIC_NEW", "Section",
 CellChangeTimes->{{3.5915944126438265`*^9, 3.591594414139574*^9}, {
  3.5922240800011873`*^9, 3.5922240809091873`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"createGHZ4Qbasic", "[", 
    RowBox[{"rawPair_", ",", 
     RowBox[{"{", 
      RowBox[{"pg_", ",", "pm_", ",", "pmem_"}], "}"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"hads", ",", "state", ",", "ppSS", ",", "ppDS", ",", "state2"}],
       "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"hads", "=", 
       RowBox[{"KP", "[", 
        RowBox[{"had", ",", "had"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"ppSS", " ", "=", " ", 
       RowBox[{"singleParityProjectMap", "[", 
        RowBox[{"rawPair", ",", 
         RowBox[{"{", 
          RowBox[{"pg", ",", "pm", ",", "pmem"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ppDS", " ", "=", " ", 
       RowBox[{"doubleParityProjectMap", "[", 
        RowBox[{"rawPair", ",", "rawPair", ",", 
         RowBox[{"{", 
          RowBox[{"pg", ",", "pm", ",", "pmem"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"state2", "=", 
       RowBox[{"applySuperoperator", "[", 
        RowBox[{"rawPair", ",", "ppDS"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"state2", "=", 
       RowBox[{"hads", ".", "state2", ".", "hads"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"state", "=", 
       RowBox[{"KP", "[", 
        RowBox[{"state2", ",", "state2"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"state", "=", 
       RowBox[{"swapQubits", "[", 
        RowBox[{"state", ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", "3"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"state", "=", 
       RowBox[{"applySuperoperator", "[", 
        RowBox[{"state", ",", "ppDS"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"state", "=", 
       RowBox[{"swapQubits", "[", 
        RowBox[{"state", ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "3"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"state", "=", 
       RowBox[{"swapQubits", "[", 
        RowBox[{"state", ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", "4"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"state", "=", 
       RowBox[{"applySuperoperator", "[", 
        RowBox[{"state", ",", "ppDS"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"twirl4QGHZ", "[", "state", "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"createGHZ3Qbasic", "[", 
   RowBox[{"rawPair_", ",", 
    RowBox[{"{", 
     RowBox[{"pg_", ",", "pm_", ",", "pmem_"}], "}"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "hads", ",", "state", ",", "ds", ",", "ss", ",", "pp2", ",", "ppSS", ",",
       "pp", ",", "ppDS", ",", "ppDS2", ",", "single"}], "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"hads", "=", 
      RowBox[{"KP", "[", 
       RowBox[{"had", ",", "had", ",", "id"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"single", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "pm"}], ")"}], "*", "plus"}], "+", 
       RowBox[{"pm", "*", "minus"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ppSS", " ", "=", " ", 
      RowBox[{"singleParityProjectMap", "[", 
       RowBox[{"rawPair", ",", 
        RowBox[{"{", 
         RowBox[{"pg", ",", "pm", ",", "pmem"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ppDS", "=", 
      RowBox[{"doubleParityProjectMap", "[", 
       RowBox[{"rawPair", ",", "rawPair", ",", 
        RowBox[{"{", 
         RowBox[{"pg", ",", "pm", ",", "pmem"}], "}"}]}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"state", "=", 
      RowBox[{"KP", "[", 
       RowBox[{"rawPair", ",", "single"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"state", "=", 
      RowBox[{"applySuperoperator", "[", 
       RowBox[{"state", ",", "ppDS"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"state", "=", 
      RowBox[{"hads", ".", "state", ".", "hads"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"state", "=", 
      RowBox[{"swapQubits", "[", 
       RowBox[{"state", ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "3"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"state", "=", 
      RowBox[{"applySuperoperator", "[", 
       RowBox[{"state", ",", "ppDS"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"state", "=", 
      RowBox[{"swapQubits", "[", 
       RowBox[{"state", ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", "3"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"state", "=", 
      RowBox[{"applySuperoperator", "[", 
       RowBox[{"state", ",", "ppDS"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"twirl3QGHZ", "[", "state", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJwlzE0og3EAx/FZU1KGi6SElZSmxGFr3nrytiG0RCI0kWlMamhpPSRFaygH
pMwOZJSXWslhxEaNdpiR8q5hPYslbJe1eX5/h1+fw6++GQq1vIvL4XBS2UG6
bF2sOmYo6xctgcKkl3I4M7BdAcP2kBwm8wTNcDjfOwjfb8815J9XmVdOGErf
VLsFJzY1hzDv+4Coy861wRtDmhNyfQEXrA5yLqFn9uEOrrXUP8Aih/wNlvxm
euFOHu2HF3qb/78n/YFPEiOx0VmTYmS1tl+nw3G6NxNed9JZcDU6Nge6xRai
fORzCn4URqZhv0u3BH2J7mXIHepYM7GalQ5i4OpI6rMx1ELMngxaR3sU3XaG
anjtIxZtWURqVq1MICZqPHUwpu1RCcW7Y/w5Vr6oOB7GnplNcCSwT3zR1WZ9
skbxJonJ9wNC6NCGCqA3EiyFno24Spj7HK6CsteEathqYm7nThnKsBgg/gG5
1Q8B
  "]]
}, Open  ]],

Cell[CellGroupData[{

Cell["REFINED", "Section",
 CellChangeTimes->{{3.592227905908697*^9, 3.5922279069357996`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Fidelity", "[", 
  RowBox[{
   RowBox[{"ghz", "[", "4", "]"}], ",", 
   RowBox[{"createGHZ4Qrefined", "[", 
    RowBox[{
     RowBox[{"\[Rho]F", "[", "0.9", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.01", ",", "0.01", ",", "0"}], "}"}]}], "]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.5922279961427193`*^9, 3.5922280278058853`*^9}}],

Cell[BoxData[
 SuperscriptBox[
  RowBox[{"(", 
   RowBox[{
    FractionBox["1", "2"], "+", 
    RowBox[{"Eigenvalues", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          FractionBox["1", "2"], ",", "0", ",", "0", ",", "0", ",", "0", ",", 
          "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
          ",", "0", ",", "0", ",", "0", ",", 
          FractionBox["1", "2"]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",",
           "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
          ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",",
           "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
          ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",",
           "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
          ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",",
           "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
          ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",",
           "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
          ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",",
           "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
          ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",",
           "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
          ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",",
           "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
          ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",",
           "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
          ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",",
           "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
          ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",",
           "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
          ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",",
           "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
          ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",",
           "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
          ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
         "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",",
           "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
          ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          FractionBox["1", "2"], ",", "0", ",", "0", ",", "0", ",", "0", ",", 
          "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
          ",", "0", ",", "0", ",", "0", ",", 
          FractionBox["1", "2"]}], "}"}]}], "}"}], ".", 
      RowBox[{"createGHZ4Qrefined", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "0.4666666666666667`", ",", "0.`", ",", "0.`", ",", 
            "0.43333333333333335`"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
           "0.`", ",", "0.033333333333333326`", ",", "0.`", ",", "0.`"}], 
           "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
           "0.`", ",", "0.`", ",", "0.033333333333333326`", ",", "0.`"}], 
           "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
           "0.43333333333333335`", ",", "0.`", ",", "0.`", ",", 
            "0.4666666666666667`"}], "}"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.01`", ",", "0.01`", ",", "0"}], "}"}]}], "]"}]}], "]"}]}],
    ")"}], "2"]], "Output",
 CellChangeTimes->{{3.5922280199701023`*^9, 3.592228028913996*^9}, 
   3.5922281250836124`*^9, {3.5922281767257757`*^9, 3.592228194755579*^9}, {
   3.592230337887558*^9, 3.5922303625314856`*^9}, 3.5929021068134165`*^9, 
   3.5931740262119374`*^9, 3.5938499086966286`*^9, 3.593849985191004*^9, {
   3.593850023203178*^9, 3.593850079828417*^9}, 3.5938501199867134`*^9, 
   3.5956806164952145`*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"createGHZ4Qrefined", "[", 
    RowBox[{"rawPair_", ",", 
     RowBox[{"{", 
      RowBox[{"pg_", ",", "pm_", ",", "pmem_"}], "}"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "hads", ",", "state", ",", "ds", ",", "ss", ",", "ppSS", ",", "ppDS", 
       ",", "ppDS2", ",", "state2"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"protocol", " ", "0"}], ",", "1", ",", "0", ",", "1", ",", "0",
        ",", "0"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"hads", "=", 
       RowBox[{"KP", "[", 
        RowBox[{"had", ",", "had"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"ppSS", " ", "=", " ", 
       RowBox[{"singleParityProjectMap", "[", 
        RowBox[{"rawPair", ",", 
         RowBox[{"{", 
          RowBox[{"pg", ",", "pm", ",", "pmem"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ppDS", "=", 
       RowBox[{"doubleParityProjectMap", "[", 
        RowBox[{"rawPair", ",", "rawPair", ",", 
         RowBox[{"{", 
          RowBox[{"pg", ",", "pm", ",", "pmem"}], "}"}]}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"ss", " ", "=", " ", 
       RowBox[{"applySuperoperator", "[", 
        RowBox[{"rawPair", ",", "ppSS"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ppDS2", "=", 
       RowBox[{"doubleParityProjectMap", "[", 
        RowBox[{"rawPair", ",", "ss", ",", 
         RowBox[{"{", 
          RowBox[{"pg", ",", "pm", ",", "pmem"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"state2", "=", 
       RowBox[{"applySuperoperator", "[", 
        RowBox[{"rawPair", ",", "ppDS2"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"state2", " ", "=", " ", 
       RowBox[{"hads", ".", "state2", ".", "hads"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"state2", "=", 
       RowBox[{"applySuperoperator", "[", 
        RowBox[{"state2", ",", "ppDS2"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"state2", " ", "=", " ", 
       RowBox[{"hads", ".", "state2", ".", "hads"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"state2", "=", 
       RowBox[{"applySuperoperator", "[", 
        RowBox[{"state2", ",", "ppDS2"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"state2", "=", 
       RowBox[{"hads", ".", "state2", ".", "hads"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"state", "=", 
       RowBox[{"KP", "[", 
        RowBox[{"state2", ",", "state2"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"state", "=", 
       RowBox[{"swapQubits", "[", 
        RowBox[{"state", ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", "3"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"state", "=", 
       RowBox[{"swapQubits", "[", 
        RowBox[{"state", ",", 
         RowBox[{"{", 
          RowBox[{"3", ",", "4"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"state", "=", 
       RowBox[{"applySuperoperator", "[", 
        RowBox[{"state", ",", "ppDS"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"state", "=", 
       RowBox[{"swapQubits", "[", 
        RowBox[{"state", ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "3"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"state", "=", 
       RowBox[{"swapQubits", "[", 
        RowBox[{"state", ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", "4"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"state", "=", 
       RowBox[{"applySuperoperator", "[", 
        RowBox[{"state", ",", "ppDS"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"state", "=", 
         RowBox[{"swapQubits", "[", 
          RowBox[{"state", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "3"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"state", "=", 
         RowBox[{"swapQubits", "[", 
          RowBox[{"state", ",", 
           RowBox[{"{", 
            RowBox[{"2", ",", "4"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"state", "=", 
         RowBox[{"applySuperoperator", "[", 
          RowBox[{"state", ",", "ppDS2"}], "]"}]}], ";"}], "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "state"}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"createGHZ3Qrefined", "[", 
   RowBox[{"rawPair_", ",", 
    RowBox[{"{", 
     RowBox[{"pg_", ",", "pm_", ",", "pmem_"}], "}"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "hads", ",", "state", ",", "ds", ",", "ss", ",", "ppSS", ",", "pp2", ",",
       "pp", ",", "ppDS", ",", "ppDS1", ",", "single"}], "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"protocol", ":", " ", 
      RowBox[{"{", 
       RowBox[{"1", ",", "0", ",", "0", ",", "1", ",", "0", ",", "1"}], 
       "}"}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"hads", "=", 
      RowBox[{"KP", "[", 
       RowBox[{"had", ",", "had", ",", "id"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"single", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "pm"}], ")"}], "*", "plus"}], "+", 
       RowBox[{"pm", "*", "minus"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ppSS", " ", "=", " ", 
      RowBox[{"singleParityProjectMap", "[", 
       RowBox[{"rawPair", ",", 
        RowBox[{"{", 
         RowBox[{"pg", ",", "pm", ",", "pmem"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"ss", " ", "=", " ", 
      RowBox[{"applySuperoperator", "[", 
       RowBox[{"rawPair", ",", "ppSS"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ss", "=", 
      RowBox[{
       RowBox[{"KP", "[", 
        RowBox[{"had", ",", "had"}], "]"}], ".", "ss", ".", 
       RowBox[{"KP", "[", 
        RowBox[{"had", ",", "had"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ss", "=", " ", 
      RowBox[{"applySuperoperator", "[", 
       RowBox[{"ss", ",", "ppSS"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ss", "=", 
      RowBox[{
       RowBox[{"KP", "[", 
        RowBox[{"had", ",", "had"}], "]"}], ".", "ss", ".", 
       RowBox[{"KP", "[", 
        RowBox[{"had", ",", "had"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"ppDS", "=", 
      RowBox[{"doubleParityProjectMap", "[", 
       RowBox[{"rawPair", ",", "rawPair", ",", 
        RowBox[{"{", 
         RowBox[{"pg", ",", "pm", ",", "pmem"}], "}"}]}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"ppDS1", " ", "=", " ", 
      RowBox[{"doubleParityProjectMap", "[", 
       RowBox[{"rawPair", ",", "ss", ",", 
        RowBox[{"{", 
         RowBox[{"pg", ",", "pm", ",", "pmem"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"state", "=", 
      RowBox[{"KP", "[", 
       RowBox[{"rawPair", ",", "single"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"state", "=", 
      RowBox[{"applySuperoperator", "[", 
       RowBox[{"state", ",", "ppDS"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"state", "=", 
      RowBox[{"hads", ".", "state", ".", "hads"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"state", "=", 
      RowBox[{"applySuperoperator", "[", 
       RowBox[{"state", ",", "ppDS"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"state", "=", 
      RowBox[{"hads", ".", "state", ".", "hads"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"state", "=", 
      RowBox[{"swapQubits", "[", 
       RowBox[{"state", ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", "3"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"state", "=", 
      RowBox[{"applySuperoperator", "[", 
       RowBox[{"state", ",", "ppDS"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"state", "=", 
        RowBox[{"applySuperoperator", "[", 
         RowBox[{"state", ",", "ppDS"}], "]"}]}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"state", "=", 
      RowBox[{"swapQubits", "[", 
       RowBox[{"state", ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "3"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"state", "=", 
      RowBox[{"applySuperoperator", "[", 
       RowBox[{"state", ",", "ppDS1"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"state", "=", 
        RowBox[{"swapQubits", "[", 
         RowBox[{"state", ",", 
          RowBox[{"{", 
           RowBox[{"2", ",", "3"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"state", "=", 
        RowBox[{"applySuperoperator", "[", 
         RowBox[{"state", ",", "ppDS1"}], "]"}]}], ";"}], "*)"}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     "state"}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",
 CellChangeTimes->{{3.591594437227112*^9, 3.5915944520295095`*^9}, {
   3.5915945430652065`*^9, 3.59159454948249*^9}, {3.591594647899169*^9, 
   3.5915946970629997`*^9}, {3.5915949032562823`*^9, 
   3.5915949263705935`*^9}, {3.5922260404001875`*^9, 3.592226075809187*^9}, {
   3.592227942875393*^9, 3.5922280058526907`*^9}, 3.5922281207721815`*^9, {
   3.592228170582162*^9, 3.5922281731794214`*^9}, {3.5922282533754396`*^9, 
   3.5922282955746593`*^9}, {3.5922283624183435`*^9, 
   3.5922284466567664`*^9}, {3.5922293585779495`*^9, 3.592229360037095*^9}, {
   3.59222951400049*^9, 3.592229555754665*^9}, {3.5922296996250505`*^9, 
   3.592229717598848*^9}, {3.5922297611372013`*^9, 3.5922297617192593`*^9}, {
   3.592229798609948*^9, 3.592229800449132*^9}, {3.592229833473434*^9, 
   3.5922299311832037`*^9}, {3.5922302372690783`*^9, 3.592230359907961*^9}, {
   3.59223042746547*^9, 3.592230513923758*^9}, {3.5938499228484383`*^9, 
   3.5938499349481297`*^9}, {3.5938499941725173`*^9, 
   3.5938500712069235`*^9}, {3.5938501078500195`*^9, 3.5938501160154867`*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.592228213478451*^9, 3.592228215939697*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["REFINED", "Section",
 CellChangeTimes->{{3.5922094015231924`*^9, 3.592209402507291*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Re", "@", 
    RowBox[{"Fidelity", "[", 
     RowBox[{
      RowBox[{"ghz", "[", "4", "]"}], ",", 
      RowBox[{"createGHZ4Qtest", "[", 
       RowBox[{
        RowBox[{"\[Rho]F", "[", "0.9", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"#", ",", "#", ",", "0"}], "}"}]}], "]"}]}], "]"}]}], "&"}], 
  "/@", 
  RowBox[{"{", 
   RowBox[{"0.003", ",", "0.005", ",", "0.007", ",", "0.01"}], 
   "}"}]}]], "Input",
 CellChangeTimes->{{3.592210264306406*^9, 3.5922103575974064`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"Re", "[", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], "+", 
       RowBox[{"Eigenvalues", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             FractionBox["1", "2"], ",", "0", ",", "0", ",", "0", ",", "0", 
             ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
             "0", ",", "0", ",", "0", ",", "0", ",", 
             FractionBox["1", "2"]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
             ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
             "0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
             ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
             "0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
             ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
             "0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
             ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
             "0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
             ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
             "0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
             ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
             "0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
             ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
             "0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
             ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
             "0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
             ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
             "0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
             ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
             "0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
             ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
             "0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
             ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
             "0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
             ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
             "0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
             ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
             "0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             FractionBox["1", "2"], ",", "0", ",", "0", ",", "0", ",", "0", 
             ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
             "0", ",", "0", ",", "0", ",", "0", ",", 
             FractionBox["1", "2"]}], "}"}]}], "}"}], ".", 
         RowBox[{"createGHZ4Qtest", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "0.4666666666666667`", ",", "0.`", ",", "0.`", ",", 
               "0.43333333333333335`"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
              "0.`", ",", "0.033333333333333326`", ",", "0.`", ",", "0.`"}], 
              "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
              "0.`", ",", "0.`", ",", "0.033333333333333326`", ",", "0.`"}], 
              "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
              "0.43333333333333335`", ",", "0.`", ",", "0.`", ",", 
               "0.4666666666666667`"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0.003`", ",", "0.003`", ",", "0"}], "}"}]}], "]"}]}], 
        "]"}]}], ")"}], "2"], "]"}], ",", 
   RowBox[{"Re", "[", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], "+", 
       RowBox[{"Eigenvalues", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             FractionBox["1", "2"], ",", "0", ",", "0", ",", "0", ",", "0", 
             ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
             "0", ",", "0", ",", "0", ",", "0", ",", 
             FractionBox["1", "2"]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
             ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
             "0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
             ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
             "0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
             ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
             "0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
             ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
             "0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
             ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
             "0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
             ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
             "0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
             ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
             "0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
             ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
             "0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
             ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
             "0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
             ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
             "0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
             ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
             "0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
             ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
             "0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
             ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
             "0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
             ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
             "0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             FractionBox["1", "2"], ",", "0", ",", "0", ",", "0", ",", "0", 
             ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
             "0", ",", "0", ",", "0", ",", "0", ",", 
             FractionBox["1", "2"]}], "}"}]}], "}"}], ".", 
         RowBox[{"createGHZ4Qtest", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "0.4666666666666667`", ",", "0.`", ",", "0.`", ",", 
               "0.43333333333333335`"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
              "0.`", ",", "0.033333333333333326`", ",", "0.`", ",", "0.`"}], 
              "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
              "0.`", ",", "0.`", ",", "0.033333333333333326`", ",", "0.`"}], 
              "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
              "0.43333333333333335`", ",", "0.`", ",", "0.`", ",", 
               "0.4666666666666667`"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0.005`", ",", "0.005`", ",", "0"}], "}"}]}], "]"}]}], 
        "]"}]}], ")"}], "2"], "]"}], ",", 
   RowBox[{"Re", "[", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], "+", 
       RowBox[{"Eigenvalues", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             FractionBox["1", "2"], ",", "0", ",", "0", ",", "0", ",", "0", 
             ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
             "0", ",", "0", ",", "0", ",", "0", ",", 
             FractionBox["1", "2"]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
             ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
             "0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
             ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
             "0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
             ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
             "0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
             ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
             "0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
             ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
             "0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
             ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
             "0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
             ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
             "0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
             ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
             "0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
             ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
             "0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
             ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
             "0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
             ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
             "0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
             ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
             "0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
             ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
             "0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
             ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
             "0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             FractionBox["1", "2"], ",", "0", ",", "0", ",", "0", ",", "0", 
             ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
             "0", ",", "0", ",", "0", ",", "0", ",", 
             FractionBox["1", "2"]}], "}"}]}], "}"}], ".", 
         RowBox[{"createGHZ4Qtest", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "0.4666666666666667`", ",", "0.`", ",", "0.`", ",", 
               "0.43333333333333335`"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
              "0.`", ",", "0.033333333333333326`", ",", "0.`", ",", "0.`"}], 
              "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
              "0.`", ",", "0.`", ",", "0.033333333333333326`", ",", "0.`"}], 
              "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
              "0.43333333333333335`", ",", "0.`", ",", "0.`", ",", 
               "0.4666666666666667`"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0.007`", ",", "0.007`", ",", "0"}], "}"}]}], "]"}]}], 
        "]"}]}], ")"}], "2"], "]"}], ",", 
   RowBox[{"Re", "[", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       FractionBox["1", "2"], "+", 
       RowBox[{"Eigenvalues", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             FractionBox["1", "2"], ",", "0", ",", "0", ",", "0", ",", "0", 
             ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
             "0", ",", "0", ",", "0", ",", "0", ",", 
             FractionBox["1", "2"]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
             ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
             "0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
             ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
             "0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
             ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
             "0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
             ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
             "0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
             ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
             "0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
             ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
             "0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
             ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
             "0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
             ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
             "0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
             ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
             "0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
             ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
             "0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
             ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
             "0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
             ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
             "0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
             ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
             "0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
             ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
             "0", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             FractionBox["1", "2"], ",", "0", ",", "0", ",", "0", ",", "0", 
             ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
             "0", ",", "0", ",", "0", ",", "0", ",", 
             FractionBox["1", "2"]}], "}"}]}], "}"}], ".", 
         RowBox[{"createGHZ4Qtest", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "0.4666666666666667`", ",", "0.`", ",", "0.`", ",", 
               "0.43333333333333335`"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
              "0.`", ",", "0.033333333333333326`", ",", "0.`", ",", "0.`"}], 
              "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
              "0.`", ",", "0.`", ",", "0.033333333333333326`", ",", "0.`"}], 
              "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
              "0.43333333333333335`", ",", "0.`", ",", "0.`", ",", 
               "0.4666666666666667`"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0.01`", ",", "0.01`", ",", "0"}], "}"}]}], "]"}]}], 
        "]"}]}], ")"}], "2"], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{3.592210740310406*^9, 3.5929021069564247`*^9, 
  3.5931740263549457`*^9, 3.59568061664723*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"0.969", ",", "0.964", ",", "0.958", ",", "0.949"}]], "Input",
 CellChangeTimes->{{3.5922104671184063`*^9, 3.5922104872744064`*^9}},
 EmphasizeSyntaxErrors->True],

Cell[BoxData[
 RowBox[{"0.971", ",", "0.965", ",", "0.959", ",", "0.951"}]], "Input",
 CellChangeTimes->{{3.592210595745406*^9, 3.5922106091544065`*^9}},
 EmphasizeSyntaxErrors->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"createGHZ4Qtest", "[", 
   RowBox[{"rawPair_", ",", 
    RowBox[{"{", 
     RowBox[{"pg_", ",", "pm_", ",", "pmem_"}], "}"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "hads", ",", "state", ",", "ds", ",", "ss", ",", "ppSS", ",", "ppDS", 
      ",", "ppDS2", ",", "state2"}], "}"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"hads", "=", 
      RowBox[{"KP", "[", 
       RowBox[{"had", ",", "had"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"ppSS", " ", "=", " ", 
      RowBox[{"singleParityProjectMap", "[", 
       RowBox[{"rawPair", ",", 
        RowBox[{"{", 
         RowBox[{"pg", ",", "pm", ",", "pmem"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ss", " ", "=", " ", 
      RowBox[{"applySuperoperator", "[", 
       RowBox[{"rawPair", ",", "ppSS"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"ppDS", "=", 
      RowBox[{"doubleParityProjectMap", "[", 
       RowBox[{"rawPair", ",", "ss", ",", 
        RowBox[{"{", 
         RowBox[{"pg", ",", "pm", ",", "pmem"}], "}"}]}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"ppDS2", "=", 
      RowBox[{"doubleParityProjectMap", "[", 
       RowBox[{"rawPair", ",", "rawPair", ",", 
        RowBox[{"{", 
         RowBox[{"pg", ",", "pm", ",", "pmem"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"state2", "=", 
      RowBox[{"applySuperoperator", "[", 
       RowBox[{"rawPair", ",", "ppDS2"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"state2", "=", 
      RowBox[{"hads", ".", "state2", ".", "hads"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"state", "=", 
      RowBox[{"KP", "[", 
       RowBox[{"state2", ",", "state2"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"state", "=", 
      RowBox[{"applySuperoperator", "[", 
       RowBox[{"state", ",", "ppDS2"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"state", "=", 
      RowBox[{"swapQubits", "[", 
       RowBox[{"state", ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", "3"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"state", "=", 
      RowBox[{"swapQubits", "[", 
       RowBox[{"state", ",", 
        RowBox[{"{", 
         RowBox[{"3", ",", "4"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"state", "=", 
      RowBox[{"applySuperoperator", "[", 
       RowBox[{"state", ",", "ppDS2"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"state", "=", 
      RowBox[{"applySuperoperator", "[", 
       RowBox[{"state", ",", "ppDS2"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"state", "=", 
      RowBox[{"swapQubits", "[", 
       RowBox[{"state", ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", "4"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"state", "=", 
      RowBox[{"applySuperoperator", "[", 
       RowBox[{"state", ",", "ppDS2"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"state", "=", 
         RowBox[{"applySuperoperator", "[", 
          RowBox[{"state", ",", "ppDS2"}], "]"}]}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"state", "=", 
        RowBox[{"swapQubits", "[", 
         RowBox[{"state", ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "3"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"state", "=", 
        RowBox[{"swapQubits", "[", 
         RowBox[{"state", ",", 
          RowBox[{"{", 
           RowBox[{"2", ",", "4"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"state", "=", 
        RowBox[{"applySuperoperator", "[", 
         RowBox[{"state", ",", "ppDS2"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"state", "=", 
        RowBox[{"swapQubits", "[", 
         RowBox[{"state", ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "3"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"state", "=", 
        RowBox[{"swapQubits", "[", 
         RowBox[{"state", ",", 
          RowBox[{"{", 
           RowBox[{"2", ",", "4"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"state", "=", 
        RowBox[{"applySuperoperator", "[", 
         RowBox[{"state", ",", "ppDS2"}], "]"}]}], ";"}], "*)"}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "state"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.592210359962406*^9, 3.592210361396406*^9}, {
  3.592210427238406*^9, 3.5922104421094065`*^9}, {3.592210511435406*^9, 
  3.592210544147406*^9}, {3.592210576084406*^9, 3.592210584952406*^9}, {
  3.592210657555406*^9, 3.5922107307084064`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"createGHZ4Qrefined", "[", 
   RowBox[{"rawPair_", ",", 
    RowBox[{"{", 
     RowBox[{"pg_", ",", "pm_", ",", "pmem_"}], "}"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"hads", ",", "state", ",", "ds", ",", "ss", ",", "ppDS"}], "}"}],
     ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ds", "=", 
      RowBox[{"Last", "@", 
       RowBox[{"runDS", "[", 
        RowBox[{"rawPair", ",", 
         RowBox[{"{", 
          RowBox[{"u", ",", "s", ",", "r"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"pg", ",", "pm", ",", "pmem"}], "}"}], ",", "3", ",", "4", 
         ",", "1"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ss", "=", 
      RowBox[{"Last", "@", 
       RowBox[{"runSS", "[", 
        RowBox[{"rawPair", ",", 
         RowBox[{"{", 
          RowBox[{"pg", ",", "pm", ",", "0"}], "}"}], ",", "3", ",", "1"}], 
        "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ppDS", "=", 
      RowBox[{"makeParityProjectDSMap", "[", 
       RowBox[{"rawPair", ",", "ss", ",", 
        RowBox[{"{", 
         RowBox[{"pg", ",", "pm", ",", "pmem"}], "}"}]}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"state", "=", 
      RowBox[{"KP", "[", 
       RowBox[{"ds", ",", "ds"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"state", "=", 
      RowBox[{"rearrangeQubits", "[", 
       RowBox[{"state", ",", "\"\<F\>\""}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"state", "=", 
      RowBox[{"applySuperoperator", "[", 
       RowBox[{"state", ",", "ppDS"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"state", "=", 
      RowBox[{"swapQubits", "[", 
       RowBox[{"state", ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "3"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"state", "=", 
      RowBox[{"swapQubits", "[", 
       RowBox[{"state", ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", "4"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"state", "=", 
      RowBox[{"applySuperoperator", "[", 
       RowBox[{"state", ",", "ppDS"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"state", "=", 
      RowBox[{"swapQubits", "[", 
       RowBox[{"state", ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "3"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"state", "=", 
      RowBox[{"swapQubits", "[", 
       RowBox[{"state", ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", "4"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"state", "=", 
      RowBox[{"applySuperoperator", "[", 
       RowBox[{"state", ",", "ppDS"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"state", "=", 
        RowBox[{"mNoise", "[", 
         RowBox[{"state", ",", "3", ",", "pmem", ",", "6"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"state", "=", 
        RowBox[{"mNoise", "[", 
         RowBox[{"state", ",", "4", ",", "pmem", ",", "6"}], "]"}]}], ";"}], 
      "*)"}], "\[IndentingNewLine]", "state"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input"]
}, Open  ]],

Cell["UNCHECKED", "Section",
 CellChangeTimes->{{3.591594474647813*^9, 3.5915944763996887`*^9}}],

Cell[CellGroupData[{

Cell["Make GHZ", "Section",
 CellChangeTimes->{{3.569584828749359*^9, 3.5695848303634515`*^9}, 
   3.5695850407334843`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"createGHZ4Q", "[", 
    RowBox[{"rawPair_", ",", 
     RowBox[{"{", 
      RowBox[{"pg_", ",", "pm_", ",", "pmem_"}], "}"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "state", ",", "list", ",", "n", ",", "ds", ",", "dsF", ",", "ss", ",", 
       "ssF", ",", "pp", ",", "ppF", ",", "ppDS", ",", "ppDSF", ",", "ppDSH", 
       ",", "hads", ",", "hads2", ",", "h2", ",", "h22", ",", "turnOne", ",", 
       "turn", ",", "best"}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"hads2", "=", 
       RowBox[{"KP", "[", 
        RowBox[{"had", ",", "had"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"hads", "=", 
       RowBox[{"KP", "[", 
        RowBox[{"had", ",", "had", ",", "had", ",", "had"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"ss", "=", 
       RowBox[{"runSingleSelection", "[", 
        RowBox[{"rawPair", ",", 
         RowBox[{"{", 
          RowBox[{"pg", ",", "pm", ",", "pmem"}], "}"}], ",", "5"}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"ds", "=", 
       RowBox[{"runDoubleSelection", "[", 
        RowBox[{"rawPair", ",", 
         RowBox[{"{", 
          RowBox[{"pg", ",", "pm", ",", "pmem"}], "}"}], ",", "5", ",", 
         "10"}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"pp", "=", 
       RowBox[{"singleParityProjectMap", "[", 
        RowBox[{"rawPair", ",", 
         RowBox[{"{", 
          RowBox[{"pg", ",", "pm", ",", "pmem"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ppDS", "=", 
       RowBox[{"doubleParityProjectMap", "[", 
        RowBox[{"rawPair", ",", "ss", ",", 
         RowBox[{"{", 
          RowBox[{"pg", ",", "pm", ",", "pmem"}], "}"}]}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Order", " ", "AB"}], ",", "CD"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"state", "=", 
       RowBox[{"KP", "[", 
        RowBox[{"ds", ",", "ds"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Reorder", " ", "to", " ", "AC"}], ",", "BD"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"state", "=", 
       RowBox[{"rearrangeQubits", "[", 
        RowBox[{"state", ",", "\"\<F\>\""}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"METHOD", " ", "2"}], " ", "-", " ", 
        RowBox[{"no", " ", "diagonal", " ", "pp"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"state", "=", 
       RowBox[{"applySuperoperator", "[", 
        RowBox[{"state", ",", "ppDS"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"state", "=", 
       RowBox[{"swapQubits", "[", 
        RowBox[{"state", ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "3"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"state", "=", 
       RowBox[{"swapQubits", "[", 
        RowBox[{"state", ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", "4"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"state", "=", 
       RowBox[{"applySuperoperator", "[", 
        RowBox[{"state", ",", "ppDS"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"state", "=", 
       RowBox[{"swapQubits", "[", 
        RowBox[{"state", ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "3"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"state", "=", 
       RowBox[{"swapQubits", "[", 
        RowBox[{"state", ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", "4"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"state", "=", 
       RowBox[{"applySuperoperator", "[", 
        RowBox[{"state", ",", "ppDS"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Chop", "@", "state"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.5695848407160435`*^9, 3.5695850266836805`*^9}, {
   3.569585220973793*^9, 3.5695852260150814`*^9}, {3.5696659937356853`*^9, 
   3.5696660865139923`*^9}, {3.5696663707132473`*^9, 
   3.5696663774116306`*^9}, {3.569666423611273*^9, 3.5696664324877806`*^9}, {
   3.570276033386958*^9, 3.5702761526667805`*^9}, 3.570276194589178*^9, {
   3.5789062646271367`*^9, 3.5789062771783915`*^9}, {3.5789065334010115`*^9, 
   3.5789065340720787`*^9}, {3.5793539175954623`*^9, 
   3.5793539193804626`*^9}, {3.5793539711674623`*^9, 
   3.5793540623564625`*^9}, {3.579358899219719*^9, 3.5793589220860057`*^9}, {
   3.579370096069179*^9, 3.579370105103696*^9}, {3.5793702636237626`*^9, 
   3.5793705345932612`*^9}, {3.5813448411918902`*^9, 3.581344894540224*^9}, {
   3.581344935952365*^9, 3.581344936580428*^9}, {3.5813973250950317`*^9, 
   3.5813973256735687`*^9}, {3.5813974674355764`*^9, 3.5813974778874855`*^9}, 
   3.591594425295149*^9, 3.5922093715731974`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"createGHZ4QSuper", "[", 
    RowBox[{"rawPair_", ",", 
     RowBox[{"{", 
      RowBox[{"pg_", ",", "pm_", ",", "pmem_"}], "}"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "state", ",", "list", ",", "n", ",", "ds", ",", "dsF", ",", "ss", ",", 
       "ssF", ",", "pp", ",", "ppF", ",", "ppDS", ",", "ppDSF", ",", "ppDSH", 
       ",", "hads", ",", "hads2", ",", "h2", ",", "h22", ",", "turnOne", ",", 
       "turn", ",", "best", ",", "i"}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"hads2", "=", 
       RowBox[{"KP", "[", 
        RowBox[{"had", ",", "had"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"hads", "=", 
       RowBox[{"KP", "[", 
        RowBox[{"had", ",", "had", ",", "had", ",", "had"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"ds", "=", 
       RowBox[{"Last", "@", 
        RowBox[{"runDS", "[", 
         RowBox[{"rawPair", ",", 
          RowBox[{"{", 
           RowBox[{"u", ",", "s", ",", "r"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"pg", ",", "pm", ",", "pmem"}], "}"}], ",", "5", ",", "10",
           ",", "1"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ss", "=", 
       RowBox[{"Last", "@", 
        RowBox[{"runSS", "[", 
         RowBox[{"rawPair", ",", 
          RowBox[{"{", 
           RowBox[{"pg", ",", "pm", ",", "0"}], "}"}], ",", "5", ",", "1"}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"pp", "=", 
       RowBox[{"makeParityProjectMap", "[", 
        RowBox[{"rawPair", ",", 
         RowBox[{"{", 
          RowBox[{"pg", ",", "pm", ",", "pmem"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ppDS", "=", 
       RowBox[{"makeParityProjectDSMap", "[", 
        RowBox[{"rawPair", ",", "ss", ",", 
         RowBox[{"{", 
          RowBox[{"pg", ",", "pm", ",", "pmem"}], "}"}]}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"turn", "=", 
       RowBox[{"makeTurnMap", "[", 
        RowBox[{"ss", ",", 
         RowBox[{"{", 
          RowBox[{"pg", ",", "pm", ",", "pmem"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Order", " ", "AB"}], ",", "CD"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"state", "=", 
       RowBox[{"KP", "[", 
        RowBox[{"ds", ",", "ds"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Reorder", " ", "to", " ", "AC"}], ",", "BD"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"state", "=", 
       RowBox[{"rearrangeQubits", "[", 
        RowBox[{"state", ",", "\"\<F\>\""}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"METHOD", " ", "2"}], " ", "-", " ", 
        RowBox[{"no", " ", "diagonal", " ", "pp"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"state", "=", 
       RowBox[{"applySuperoperator", "[", 
        RowBox[{"state", ",", "ppDS"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"state", "=", 
       RowBox[{"swapQubits", "[", 
        RowBox[{"state", ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "3"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"state", "=", 
       RowBox[{"swapQubits", "[", 
        RowBox[{"state", ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", "4"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"state", "=", 
       RowBox[{"applySuperoperator", "[", 
        RowBox[{"state", ",", "ppDS"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"state", "=", 
       RowBox[{"swapQubits", "[", 
        RowBox[{"state", ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "3"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"state", "=", 
       RowBox[{"swapQubits", "[", 
        RowBox[{"state", ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", "4"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"state", "=", 
       RowBox[{"applySuperoperator", "[", 
        RowBox[{"state", ",", "ppDS"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"state", "=", 
       RowBox[{"swapQubits", "[", 
        RowBox[{"state", ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "3"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"state", "=", 
       RowBox[{"applySuperoperator", "[", 
        RowBox[{"state", ",", "ppDS"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"state", "=", 
       RowBox[{"swapQubits", "[", 
        RowBox[{"state", ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "3"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"state", "=", 
       RowBox[{"swapQubits", "[", 
        RowBox[{"state", ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", "4"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"state", "=", 
       RowBox[{"applySuperoperator", "[", 
        RowBox[{"state", ",", "ppDS"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"state", "=", 
       RowBox[{"swapQubits", "[", 
        RowBox[{"state", ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "3"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"state", "=", 
       RowBox[{"applySuperoperator", "[", 
        RowBox[{"state", ",", "turn"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"state", "=", 
       RowBox[{"swapQubits", "[", 
        RowBox[{"state", ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "3"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"state", "=", 
       RowBox[{"swapQubits", "[", 
        RowBox[{"state", ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", "4"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"state", "=", 
       RowBox[{"applySuperoperator", "[", 
        RowBox[{"state", ",", "turn"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"state", "=", 
       RowBox[{"applySuperoperator", "[", 
        RowBox[{"state", ",", "ppDS"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"state", "=", 
       RowBox[{"swapQubits", "[", 
        RowBox[{"state", ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "3"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"state", "=", 
       RowBox[{"applySuperoperator", "[", 
        RowBox[{"state", ",", "ppDS"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"state", "=", 
       RowBox[{"swapQubits", "[", 
        RowBox[{"state", ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "3"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"state", "=", 
       RowBox[{"swapQubits", "[", 
        RowBox[{"state", ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", "4"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"state", "=", 
         RowBox[{"applySuperoperator", "[", 
          RowBox[{"state", ",", "ppDS"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"state", "=", 
         RowBox[{"swapQubits", "[", 
          RowBox[{"state", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "3"}], "}"}]}], "]"}]}], ";"}], "*)"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"state", "=", 
       RowBox[{"mNoise", "[", 
        RowBox[{"state", ",", "3", ",", "pmem", ",", "6"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"state", "=", 
       RowBox[{"mNoise", "[", 
        RowBox[{"state", ",", "4", ",", "pmem", ",", "6"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "state"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.5695848407160435`*^9, 3.5695850266836805`*^9}, {
  3.569585220973793*^9, 3.5695852260150814`*^9}, {3.5696659937356853`*^9, 
  3.5696660865139923`*^9}, {3.5696663707132473`*^9, 3.5696663774116306`*^9}, {
  3.569666423611273*^9, 3.5696664324877806`*^9}, {3.5702759446058807`*^9, 
  3.570275945251917*^9}, {3.5702761583271046`*^9, 3.5702761614712844`*^9}, {
  3.5702761982263865`*^9, 3.5702763253856597`*^9}, {3.5702763967517414`*^9, 
  3.57027657103971*^9}, {3.570276621065572*^9, 3.5702766486881514`*^9}, {
  3.5702766804219666`*^9, 3.570276681500028*^9}, {3.570276719937227*^9, 
  3.5702767491328964`*^9}, {3.5702768012128754`*^9, 3.570276930372263*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["create GHZ 3", "Section",
 CellChangeTimes->{{3.570171268893989*^9, 3.5701712693730164`*^9}, {
  3.570171315324645*^9, 3.570171319597889*^9}, {3.5813473553923225`*^9, 
  3.581347356544438*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"createGHZ3Q", "[", 
    RowBox[{"rawPair_", ",", 
     RowBox[{"{", 
      RowBox[{"pg_", ",", "pm_", ",", "pmem_"}], "}"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "state", ",", "ds", ",", "ss", ",", "pp", ",", "ppDS", ",", "turn", ",",
        "hadamard", ",", "single", ",", "i"}], "}"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"hadamard", "=", 
       RowBox[{"KP", "[", 
        RowBox[{"id", ",", "id", ",", "had"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"single", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "pm"}], ")"}], "*", "plus"}], "+", 
        RowBox[{"pm", "*", "minus"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"ss", "=", 
       RowBox[{"runSingleSelection", "[", 
        RowBox[{"rawPair", ",", 
         RowBox[{"{", 
          RowBox[{"pg", ",", "pm", ",", "pmem"}], "}"}], ",", "5"}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"ds", "=", 
       RowBox[{"runDoubleSelection", "[", 
        RowBox[{"rawPair", ",", 
         RowBox[{"{", 
          RowBox[{"pg", ",", "pm", ",", "pmem"}], "}"}], ",", "5", ",", 
         "10"}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"pp", "=", 
       RowBox[{"singleParityProjectMap", "[", 
        RowBox[{"rawPair", ",", 
         RowBox[{"{", 
          RowBox[{"pg", ",", "pm", ",", "pmem"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"ppDS", "=", 
       RowBox[{"doubleParityProjectMap", "[", 
        RowBox[{"rawPair", ",", "ss", ",", 
         RowBox[{"{", 
          RowBox[{"pg", ",", "pm", ",", "pmem"}], "}"}]}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"turn", "=", 
       RowBox[{"turnMap", "[", 
        RowBox[{"ss", ",", 
         RowBox[{"{", 
          RowBox[{"pg", ",", "pm", ",", "pmem"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Order", " ", "A"}], ",", "BC"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"state", "=", 
       RowBox[{"KP", "[", 
        RowBox[{"single", ",", "ds"}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"state", "=", 
       RowBox[{"applySuperoperator", "[", 
        RowBox[{"state", ",", "ppDS"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"state", "=", 
       RowBox[{"swapQubits", "[", 
        RowBox[{"state", ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", "3"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"state", "=", 
       RowBox[{"applySuperoperator", "[", 
        RowBox[{"state", ",", "ppDS"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"state", "=", 
       RowBox[{"swapQubits", "[", 
        RowBox[{"state", ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "3"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "0"}], ",", 
        RowBox[{"i", "\[LessEqual]", "3"}], ",", 
        RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"state", "=", 
          RowBox[{"applySuperoperator", "[", 
           RowBox[{"state", ",", "turn"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"state", "=", 
          RowBox[{"hadamard", ".", "state", ".", "hadamard"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"state", "=", 
          RowBox[{"applySuperoperator", "[", 
           RowBox[{"state", ",", "ppDS"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"state", "=", 
          RowBox[{"swapQubits", "[", 
           RowBox[{"state", ",", 
            RowBox[{"{", 
             RowBox[{"2", ",", "3"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"state", "=", 
          RowBox[{"applySuperoperator", "[", 
           RowBox[{"state", ",", "ppDS"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"state", "=", 
          RowBox[{"swapQubits", "[", 
           RowBox[{"state", ",", 
            RowBox[{"{", 
             RowBox[{"1", ",", "3"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"state", "=", 
          RowBox[{"applySuperoperator", "[", 
           RowBox[{"state", ",", "ppDS"}], "]"}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"state", "=", 
         RowBox[{"mNoise", "[", 
          RowBox[{"state", ",", "3", ",", "pmem", ",", "6"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"state", "=", 
         RowBox[{"mNoise", "[", 
          RowBox[{"state", ",", "4", ",", "pmem", ",", "6"}], "]"}]}], ";"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Chop", "@", "state"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.5696670515241876`*^9, 3.5696670519292107`*^9}, {
   3.5696671303096933`*^9, 3.569667244348216*^9}, {3.5696678808356214`*^9, 
   3.569667882862737*^9}, {3.570179006208538*^9, 3.5701790291828527`*^9}, {
   3.570179534182737*^9, 3.570179555655965*^9}, {3.5701795990754485`*^9, 
   3.57017961851456*^9}, {3.570183171872801*^9, 3.5701831914799223`*^9}, {
   3.5701832605668736`*^9, 3.5701832607858863`*^9}, {3.5701832943268046`*^9, 
   3.570183383151885*^9}, {3.570183413960647*^9, 3.57018341418566*^9}, {
   3.570183517236554*^9, 3.570183539121806*^9}, {3.57018358849363*^9, 
   3.5701836183343368`*^9}, {3.5701837807746277`*^9, 
   3.5701837845978465`*^9}, {3.570195361848027*^9, 3.5701953653442273`*^9}, 
   3.570195673192835*^9, {3.570195953973895*^9, 3.570195956191022*^9}, {
   3.570196122127513*^9, 3.5701961288168955`*^9}, {3.5701961746575174`*^9, 
   3.5701961767906394`*^9}, {3.5701972266916904`*^9, 
   3.5701972620737143`*^9}, {3.5702706344091544`*^9, 3.570270760006338*^9}, {
   3.570270791668149*^9, 3.5702708605750904`*^9}, {3.5702708975362043`*^9, 
   3.5702708983422503`*^9}, {3.57027120849199*^9, 3.5702712952999554`*^9}, {
   3.5702713394654813`*^9, 3.57027165117131*^9}, {3.5702716833201485`*^9, 
   3.5702717146479406`*^9}, {3.5702717927834096`*^9, 3.5702717932764378`*^9}, 
   3.5702719658023057`*^9, {3.570272178621478*^9, 3.5702722448842683`*^9}, {
   3.5702723440519404`*^9, 3.5702725899380045`*^9}, {3.5702727579096117`*^9, 
   3.570272927590317*^9}, {3.5702733930459394`*^9, 3.5702733951040573`*^9}, {
   3.5775307018915887`*^9, 3.5775307344894533`*^9}, {3.577530826819734*^9, 
   3.577530827589778*^9}, 3.577530876355568*^9, {3.577776386188096*^9, 
   3.5777764545100036`*^9}, {3.581361969163226*^9, 3.5813620212133346`*^9}, {
   3.5813620847116838`*^9, 3.5813620854617586`*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.577530678555254*^9, 3.5775306797203207`*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.5799647889411955`*^9, 3.579964790165318*^9}, 
   3.5799648695062513`*^9}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.5782942573342466`*^9, 3.5782942627942467`*^9}, 
   3.578294301651246*^9}],

Cell[CellGroupData[{

Cell["BASIC ghz state", "Subsection",
 CellChangeTimes->{{3.578738271831647*^9, 3.5787382771971836`*^9}}],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.5782915587672515`*^9, 3.578291630100251*^9}, {
   3.5787319673296275`*^9, 3.578731968397689*^9}, {3.57873201685146*^9, 
   3.5787320824402113`*^9}, {3.5787322831209545`*^9, 
   3.5787323450993557`*^9}, {3.5787324499238987`*^9, 
   3.5787324527470512`*^9}, {3.578732485523841*^9, 3.5787324861007833`*^9}, {
   3.5787326687935123`*^9, 3.5787328079116554`*^9}, {3.5787331092426558`*^9, 
   3.5787331940686555`*^9}, {3.5787343278983064`*^9, 
   3.5787344001785336`*^9}, {3.578734587738288*^9, 3.578734877002211*^9}, {
   3.578735035127022*^9, 3.5787350388493943`*^9}, {3.578738288023266*^9, 
   3.5787383431807814`*^9}, {3.579354167544462*^9, 3.5793542137104626`*^9}, {
   3.5793545232834625`*^9, 3.5793545255224624`*^9}, {3.579356099956821*^9, 
   3.579356295885412*^9}, {3.5793563361074333`*^9, 3.5793564117139935`*^9}, {
   3.5793564495747795`*^9, 3.5793565953403544`*^9}, {3.5793566346772876`*^9, 
   3.579356654822302*^9}, {3.5793590872815237`*^9, 3.579359143426138*^9}, {
   3.5793591938411784`*^9, 3.579359620307821*^9}, {3.5795137782926393`*^9, 
   3.579513796405391*^9}, 3.591594895714528*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"createGHZ3Qrefined2", "[", 
   RowBox[{"rawPair_", ",", 
    RowBox[{"{", 
     RowBox[{"pg_", ",", "pm_", ",", "pmem_"}], "}"}]}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "hads", ",", "state", ",", "ds", ",", "ss", ",", "ppDS", ",", "single"}],
      "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"hads", "=", 
      RowBox[{"KP", "[", 
       RowBox[{"had", ",", "had"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"single", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "pm"}], ")"}], "*", "plus"}], "+", 
       RowBox[{"pm", "*", "minus"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ds", "=", 
      RowBox[{"Last", "@", 
       RowBox[{"runDS", "[", 
        RowBox[{"rawPair", ",", 
         RowBox[{"{", 
          RowBox[{"u", ",", "s", ",", "r"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"pg", ",", "pm", ",", "pmem"}], "}"}], ",", "3", ",", "4", 
         ",", "1"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ss", "=", 
      RowBox[{"Last", "@", 
       RowBox[{"runSS", "[", 
        RowBox[{"rawPair", ",", 
         RowBox[{"{", 
          RowBox[{"pg", ",", "pm", ",", "0"}], "}"}], ",", "5", ",", "1"}], 
        "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ppDS", "=", 
      RowBox[{"makeParityProjectDSMap", "[", 
       RowBox[{"rawPair", ",", "ss", ",", 
        RowBox[{"{", 
         RowBox[{"pg", ",", "pm", ",", "pmem"}], "}"}]}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"state", "=", "rawPair"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"double", " ", "selection", " ", "on", " ", "1"}], ",", "2"}], 
      " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"state", "=", 
      RowBox[{"applySuperoperator", "[", 
       RowBox[{"state", ",", "ppDS"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"state", "=", 
      RowBox[{"hads", ".", "state", ".", "hads"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"state", "=", 
      RowBox[{"applySuperoperator", "[", 
       RowBox[{"state", ",", "ppDS"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"state", "=", 
      RowBox[{"hads", ".", "state", ".", "hads"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"state", "=", 
      RowBox[{"applySuperoperator", "[", 
       RowBox[{"state", ",", "ppDS"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"state", "=", 
      RowBox[{"applySuperoperator", "[", 
       RowBox[{"state", ",", "ppDS"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Fidelity", "[", 
        RowBox[{"phi0", ",", "#"}], "]"}], "&"}], "/@", 
      RowBox[{"{", 
       RowBox[{"state", ",", "ds"}], "}"}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.5793566768705063`*^9, 3.57935674751157*^9}, {
  3.579356852333051*^9, 3.5793568884006577`*^9}, {3.5793569363034472`*^9, 
  3.579356949621779*^9}, {3.5793589489586926`*^9, 3.5793589700478015`*^9}, {
  3.579359015307327*^9, 3.5793590156133575`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"createGHZ3Qrefined", "[", 
    RowBox[{"rawPair_", ",", 
     RowBox[{"{", 
      RowBox[{"pg_", ",", "pm_", ",", "pmem_"}], "}"}]}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"state", ",", "ds", ",", "ss", ",", "ppDS", ",", "single"}], 
      "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"single", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "pm"}], ")"}], "*", "plus"}], "+", 
        RowBox[{"pm", "*", "minus"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ds", "=", 
       RowBox[{"Last", "@", 
        RowBox[{"runDS", "[", 
         RowBox[{"rawPair", ",", 
          RowBox[{"{", 
           RowBox[{"u", ",", "s", ",", "r"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"pg", ",", "pm", ",", "pmem"}], "}"}], ",", "3", ",", "4", 
          ",", "1"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ss", "=", 
       RowBox[{"Last", "@", 
        RowBox[{"runSS", "[", 
         RowBox[{"rawPair", ",", 
          RowBox[{"{", 
           RowBox[{"pg", ",", "pm", ",", "0"}], "}"}], ",", "5", ",", "1"}], 
         "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"ppDS", "=", 
       RowBox[{"makeParityProjectDSMap", "[", 
        RowBox[{"rawPair", ",", "ss", ",", 
         RowBox[{"{", 
          RowBox[{"pg", ",", "pm", ",", "pmem"}], "}"}]}], "]"}]}], ";", " ", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"state", "=", 
       RowBox[{"KP", "[", 
        RowBox[{"single", ",", "ds"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"state", "=", 
       RowBox[{"applySuperoperator", "[", 
        RowBox[{"state", ",", "ppDS"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"state", "=", 
       RowBox[{"swapQubits", "[", 
        RowBox[{"state", ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", "3"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"state", "=", 
       RowBox[{"applySuperoperator", "[", 
        RowBox[{"state", ",", "ppDS"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"state", "=", 
       RowBox[{"swapQubits", "[", 
        RowBox[{"state", ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", "3"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"state", "=", 
       RowBox[{"applySuperoperator", "[", 
        RowBox[{"state", ",", "ppDS"}], "]"}]}]}]}], "\[IndentingNewLine]", 
    "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.5782915587672515`*^9, 3.578291630100251*^9}, {
  3.5787319673296275`*^9, 3.578731968397689*^9}, {3.57873201685146*^9, 
  3.5787320824402113`*^9}, {3.5787322831209545`*^9, 3.5787323450993557`*^9}, {
  3.5787324499238987`*^9, 3.5787324527470512`*^9}, {3.578732485523841*^9, 
  3.5787324861007833`*^9}, {3.5787326687935123`*^9, 3.5787328079116554`*^9}, {
  3.5787331092426558`*^9, 3.5787331940686555`*^9}, {3.5787343278983064`*^9, 
  3.5787344001785336`*^9}, {3.578734587738288*^9, 3.578734877002211*^9}, {
  3.578735035127022*^9, 3.5787350388493943`*^9}, {3.578738288023266*^9, 
  3.5787383431807814`*^9}, {3.579354167544462*^9, 3.5793542137104626`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"createGHZ3Q2", "[", 
   RowBox[{"rawPair_", ",", 
    RowBox[{"{", 
     RowBox[{"pg_", ",", "pm_", ",", "pmem_"}], "}"}]}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "state", ",", "ds", ",", "ss1", ",", "ss2", ",", "pp", ",", "ppDS", ",", 
      "turn", ",", "hadamard", ",", "single", ",", "i"}], "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"hadamard", "=", 
      RowBox[{"KP", "[", 
       RowBox[{"id", ",", "id", ",", "had"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"single", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "pm"}], ")"}], "*", "plus"}], "+", 
       RowBox[{"pm", "*", "minus"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ds", "=", 
      RowBox[{"Last", "@", 
       RowBox[{"runDS", "[", 
        RowBox[{"rawPair", ",", 
         RowBox[{"{", 
          RowBox[{"u", ",", "s", ",", "r"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"pg", ",", "pm", ",", "pmem"}], "}"}], ",", "5", ",", "10", 
         ",", "1"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ss1", "=", 
      RowBox[{"Last", "@", 
       RowBox[{"runSS", "[", 
        RowBox[{"rawPair", ",", 
         RowBox[{"{", 
          RowBox[{"pg", ",", "pm", ",", "0"}], "}"}], ",", "5", ",", "1"}], 
        "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"ss2", "=", 
      RowBox[{"Last", "@", 
       RowBox[{"runSS", "[", 
        RowBox[{"rawPair", ",", 
         RowBox[{"{", 
          RowBox[{"pg", ",", "pm", ",", "0"}], "}"}], ",", "5", ",", "1"}], 
        "]"}]}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"pp", "=", 
      RowBox[{"makeParityProjectMap", "[", 
       RowBox[{"rawPair", ",", 
        RowBox[{"{", 
         RowBox[{"pg", ",", "pm", ",", "pmem"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ppDS", "=", 
      RowBox[{"makeParityProjectDSMap", "[", 
       RowBox[{"rawPair", ",", "ss1", ",", 
        RowBox[{"{", 
         RowBox[{"pg", ",", "pm", ",", "pmem"}], "}"}]}], "]"}]}], ";", " ", 
     "\[IndentingNewLine]", 
     RowBox[{"turn", "=", 
      RowBox[{"makeTurnMap", "[", 
       RowBox[{"ss2", ",", 
        RowBox[{"{", 
         RowBox[{"pg", ",", "pm", ",", "pmem"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Order", " ", "A"}], ",", "BC"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"state", "=", 
      RowBox[{"KP", "[", 
       RowBox[{"single", ",", "ds"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"state", "=", 
      RowBox[{"applySuperoperator", "[", 
       RowBox[{"state", ",", "ppDS"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"state", "=", 
      RowBox[{"swapQubits", "[", 
       RowBox[{"state", ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", "3"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"state", "=", 
      RowBox[{"applySuperoperator", "[", 
       RowBox[{"state", ",", "ppDS"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"state", "=", 
      RowBox[{"applySuperoperator", "[", 
       RowBox[{"state", ",", "ppDS"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"state", "=", 
        RowBox[{"swapQubits", "[", 
         RowBox[{"state", ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "3"}], "}"}]}], "]"}]}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"state", "=", 
      RowBox[{"applySuperoperator", "[", 
       RowBox[{"state", ",", "turn"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"state", "=", 
      RowBox[{"hadamard", ".", "state", ".", "hadamard"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"state", "=", 
      RowBox[{"applySuperoperator", "[", 
       RowBox[{"state", ",", "ppDS"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"state", "=", 
      RowBox[{"swapQubits", "[", 
       RowBox[{"state", ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", "3"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"state", "=", 
      RowBox[{"applySuperoperator", "[", 
       RowBox[{"state", ",", "ppDS"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"--", 
       RowBox[{"--", "-"}]}], "*)"}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"state", "=", 
      RowBox[{"applySuperoperator", "[", 
       RowBox[{"state", ",", "ppDS"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"state", "=", 
        RowBox[{"applySuperoperator", "[", 
         RowBox[{"state", ",", "turn"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"state", "=", 
        RowBox[{"hadamard", ".", "state", ".", "hadamard"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"state", "=", 
        RowBox[{"applySuperoperator", "[", 
         RowBox[{"state", ",", "ppDS"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"state", "=", 
        RowBox[{"swapQubits", "[", 
         RowBox[{"state", ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "3"}], "}"}]}], "]"}]}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"state", "=", 
        RowBox[{"applySuperoperator", "[", 
         RowBox[{"state", ",", "ppDS"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"state", "=", 
        RowBox[{"swapQubits", "[", 
         RowBox[{"state", ",", 
          RowBox[{"{", 
           RowBox[{"2", ",", "3"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"state", "=", 
        RowBox[{"applySuperoperator", "[", 
         RowBox[{"state", ",", "ppDS"}], "]"}]}], ";"}], "*)"}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "0"}], ",", 
         RowBox[{"i", "\[LessEqual]", "3"}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"state", "=", 
           RowBox[{"applySuperoperator", "[", 
            RowBox[{"state", ",", "turn"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"state", "=", 
           RowBox[{"hadamard", ".", "state", ".", "hadamard"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"state", "=", 
           RowBox[{"applySuperoperator", "[", 
            RowBox[{"state", ",", "ppDS"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"state", "=", 
           RowBox[{"swapQubits", "[", 
            RowBox[{"state", ",", 
             RowBox[{"{", 
              RowBox[{"2", ",", "3"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"state", "=", 
           RowBox[{"applySuperoperator", "[", 
            RowBox[{"state", ",", "ppDS"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"state", "=", 
           RowBox[{"swapQubits", "[", 
            RowBox[{"state", ",", 
             RowBox[{"{", 
              RowBox[{"1", ",", "3"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"state", "=", 
           RowBox[{"applySuperoperator", "[", 
            RowBox[{"state", ",", "ppDS"}], "]"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"state", "=", 
        RowBox[{"mNoise", "[", 
         RowBox[{"state", ",", "3", ",", "pmem", ",", "6"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"state", "=", 
        RowBox[{"mNoise", "[", 
         RowBox[{"state", ",", "4", ",", "pmem", ",", "6"}], "]"}]}], ";"}], 
      "*)"}], "\[IndentingNewLine]", "state"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{
  3.5777764787383895`*^9, {3.5777765110612383`*^9, 3.5777765501864758`*^9}, {
   3.5777765916768494`*^9, 3.5777767532300897`*^9}, {3.577781242161842*^9, 
   3.5777814815445337`*^9}, {3.5777815243199806`*^9, 3.577781542268007*^9}, {
   3.577782557535077*^9, 3.5777826126342287`*^9}, {3.57778332353989*^9, 
   3.5777835393442335`*^9}, {3.5777837974789977`*^9, 3.5777838745154037`*^9}, 
   3.5777840494514093`*^9, {3.577784095427039*^9, 3.57778413478629*^9}, {
   3.5777842078284683`*^9, 3.577784218654087*^9}, {3.5777842983866477`*^9, 
   3.5777843144675674`*^9}, {3.5787319769771795`*^9, 3.5787320016345897`*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.5775303614491167`*^9, 3.5775303619691463`*^9}, {
  3.577530676268123*^9, 3.577530676953162*^9}}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{767, 604},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"8.0 for Microsoft Windows (64-bit) (February 23, 2011)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 149, 2, 71, "Section"],
Cell[731, 26, 5883, 144, 912, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6651, 175, 94, 1, 71, "Section"],
Cell[CellGroupData[{
Cell[6770, 180, 367, 10, 31, "Input"],
Cell[7140, 192, 5371, 119, 327, "Output"]
}, Open  ]],
Cell[12526, 314, 10499, 248, 1392, "Input"],
Cell[23028, 564, 92, 1, 31, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[23157, 570, 94, 1, 71, "Section"],
Cell[CellGroupData[{
Cell[23276, 575, 532, 16, 31, "Input"],
Cell[23811, 593, 21473, 460, 1170, "Output"]
}, Open  ]],
Cell[45299, 1056, 185, 3, 31, "Input"],
Cell[45487, 1061, 183, 3, 31, "Input"],
Cell[45673, 1066, 4946, 123, 672, "Input"],
Cell[50622, 1191, 3293, 85, 432, "Input"]
}, Open  ]],
Cell[53930, 1279, 96, 1, 70, "Section"],
Cell[CellGroupData[{
Cell[54051, 1284, 123, 2, 41, "Section"],
Cell[54177, 1288, 5558, 124, 972, "Input"],
Cell[59738, 1414, 9025, 216, 1292, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[68800, 1635, 199, 3, 71, "Section"],
Cell[69002, 1640, 7116, 156, 832, "Input"],
Cell[76121, 1798, 94, 1, 31, "Input"],
Cell[76218, 1801, 122, 2, 31, "Input"],
Cell[76343, 1805, 122, 2, 31, "Input"],
Cell[CellGroupData[{
Cell[76490, 1811, 105, 1, 36, "Subsection"],
Cell[76598, 1814, 1250, 18, 112, "Input"],
Cell[77851, 1834, 3277, 80, 432, "Input"],
Cell[81131, 1916, 3332, 75, 372, "Input"],
Cell[84466, 1993, 8898, 216, 1232, "Input"],
Cell[93367, 2211, 145, 2, 31, "Input"]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
